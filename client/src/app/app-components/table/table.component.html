<div class="w-full h-auto">
  <div class="w-full mx-auto bg-[#0f0f0f] rounded-lg shadow overflow-hidden">
    <div class="p-4 flex items-center justify-between">
      <div class="flex space-x-4">
        <input type="text" class="p-2 border border-[#49a5ab] rounded-md bg-[#111111] text-[#f1f1f1]" placeholder="Search..." [(ngModel)]="searchTerm"
          (input)="applySearch()">
      </div>
      <div class="flex space-x-4">
        <button class="bg-[#28729e] text-[#f1f1f1] p-2 rounded hover:bg-[#1a3757]">Select Dates</button>
        <button class="bg-[#28729e] text-[#f1f1f1] p-2 rounded hover:bg-[#1a3757]">Sort</button>
        <button class="bg-[#28729e] text-[#f1f1f1] p-2 rounded hover:bg-[#1a3757]">Group</button>
      </div>
    </div>

    <table class="min-w-full divide-y divide-[#4f504f]">
      <thead class="bg-[#101010]">
        <tr>
          <th class="px-6 py-3 text-left text-xs font-medium text-[#c8c7ba] uppercase tracking-wider">
            <input type="checkbox" class="form-checkbox h-4 w-4 text-[#49a5ab] transition duration-150 ease-in-out"
              (change)="toggleAllCheckboxes($event)">
          </th>
          <th class="px-6 py-3 text-left text-xs font-medium text-[#c8c7ba] uppercase tracking-wider cursor-pointer"
            (click)="sortTable('dateImported')">
            Date Imported
            <span *ngIf="sortColumn === 'dateImported'">
              {{ sortDirection === 'asc' ? '↑' : '↓' }}
            </span>
          </th>
          <th class="px-6 py-3 text-left text-xs font-medium text-[#c8c7ba] uppercase tracking-wider cursor-pointer"
            (click)="sortTable('dateUpdated')">
            Date Updated
            <span *ngIf="sortColumn === 'dateUpdated'">
              {{ sortDirection === 'asc' ? '↑' : '↓' }}
            </span>
          </th>
          <th class="px-6 py-3 text-left text-xs font-medium text-[#c8c7ba] uppercase tracking-wider">Import By</th>
          <th class="px-6 py-3 text-left text-xs font-medium text-[#c8c7ba] uppercase tracking-wider">Batch ID</th>
          <th class="px-6 py-3 text-left text-xs font-medium text-[#c8c7ba] uppercase tracking-wider">Import Name & Tool
          </th>
          <th class="px-6 py-3 text-left text-xs font-medium text-[#c8c7ba] uppercase tracking-wider">Total Items</th>
          <th class="px-6 py-3 text-left text-xs font-medium text-[#c8c7ba] uppercase tracking-wider">Progress</th>
          <th class="px-6 py-3 text-left text-xs font-medium text-[#c8c7ba] uppercase tracking-wider">Status</th>
          <th class="px-6 py-3 text-left text-xs font-medium text-[#c8c7ba] uppercase tracking-wider">Actions</th>
        </tr>
      </thead>
      <tbody class="bg-[#0f0f0f] divide-y divide-[#4f504f]">
        <tr *ngFor="let row of tableData"
          [ngClass]="{ 'bg-[#332c28] hover:bg-[#0f0f0f]': row.hidden, 'bg-[#111111] hover:bg-[#1d1e1f]': !row.hidden }">
          <td class="px-6 py-4 whitespace-no-wrap">
            <input type="checkbox" class="form-checkbox h-4 w-4 text-[#49a5ab] transition duration-150 ease-in-out"
              [(ngModel)]="row.selected">
          </td>
          <td class="px-6 py-4 whitespace-no-wrap text-sm font-medium text-[#f1f1f1]">{{row.dateImported}}</td>
          <td class="px-6 py-4 whitespace-no-wrap text-sm text-[#c8c7ba]">{{row.dateUpdated}}</td>
          <td class="px-6 py-4 whitespace-no-wrap text-sm text-[#c8c7ba]">{{row.importBy}}</td>
          <td class="px-6 py-4 whitespace-no-wrap text-sm text-[#c8c7ba]">{{row.batchId}}</td>
          <td class="px-6 py-4 whitespace-no-wrap text-sm text-[#c8c7ba]">
            <div>
              {{row.importNameTool}}
            </div>
            <div>
              {{row.batchName}}
            </div>
          </td>
          <td class="px-6 py-4 whitespace-no-wrap text-sm text-[#c8c7ba]">
            <span class="px-2 inline-flex text-xs leading-5 font-semibold rounded-full">
              {{ row.totalItems }}
            </span>
          </td>
          <td class="px-6 py-4 whitespace-no-wrap text-sm text-[#c8c7ba]">
            <div class="w-full bg-[#4f504f] rounded-full h-2">
              <div [ngStyle]="{ 'background-color': getProgressBarColor(row.progress), width: row.progress + '%' }"
                class="h-2 rounded-full">
              </div>
            </div>
            <span class="text-[0.7rem]">{{ row.progress }}% of {{row.totalItems}} items</span>
          </td>
          <td class="px-6 py-4 whitespace-no-wrap text-sm text-[#c8c7ba]">
            <span [ngClass]="row.statusClass" class="px-2 inline-flex text-xs leading-5 font-semibold rounded-full">
              {{ row.status }}
            </span>
          </td>
          <td class="px-6 py-4 whitespace-no-wrap text-sm text-[#c8c7ba]">
            <a class="cursor-pointer text-[#f1f1f1] hover:text-green-200 px-2 py-1 rounded"
              [class.cursor-not-allowed]="row.progress < 100" [class.bg-[#4f504f]]="row.progress < 100"
              [class.text-[#c8c7ba]]="row.progress < 100" (click)="downloadResult(row.batchId, row.progress)"
              [attr.disabled]="row.progress < 100 ? true : null">
              <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" class="size-6">
                <path stroke-linecap="round" stroke-linejoin="round" d="M3 16.5v2.25A2.25 2.25 0 0 0 5.25 21h13.5A2.25 2.25 0 0 0 21 18.75V16.5M16.5 12 12 16.5m0 0L7.5 12m4.5 4.5V3" />
              </svg>           
            </a>
            
          </td>
        </tr>
      </tbody>
    </table>
    <div class="p-4 flex justify-between items-center">
      <button class="bg-[#28729e] text-[#f1f1f1] p-2 rounded hover:bg-[#1a3757]" (click)="previousPage()" [disabled]="page === 1">
        Previous
      </button>
      <span class="text-[#f1f1f1]">Page {{page}} of {{totalPages}}</span>
      <button class="bg-[#28729e] text-[#f1f1f1] p-2 rounded hover:bg-[#1a3757]" (click)="nextPage()" [disabled]="page >= totalPages">
        Next
      </button>
    </div>
  </div>
</div>
